<?xml version="1.0"?>
<!--
  www.newskysoft.com.cn
  all right reserved, 2005-2012.  
-->
<project name="zy-daemon" default="jar" basedir=".">

	<tstamp>
      <format property="touch.time" pattern="yyyy.MMdd.HHmm"/>
	</tstamp>

	<property name="jar.name" value="zy-daemon.jar"/>
	<property name="build.dir" value="build"/>
	<property name="src.dir" value="src"/>
	<property name="classes.dir" value="build/classes"/>
	<property name="lib.dir" value="WebContent/WEB-INF/lib"/>
	<property name="thirtyparty.lib.dir" value="build/lib"/>
	
	<path id="classpath">
	  <fileset dir="${lib.dir}" includes="**/*.jar"/>
	</path>

	<target name="clean">
	  <delete dir="${build.dir}"/>
	</target>

	<target name="compile" depends="makeversion">
	  <mkdir dir="${classes.dir}"/>
	  <javac srcdir="${src.dir}" encoding="utf-8" destdir="${classes.dir}" classpathref="classpath"/>
	</target>

	<target name="copylib" depends="clean">
	  <copy todir="${thirtyparty.lib.dir}">
		<fileset dir="${lib.dir}" includes="**/*.jar"/>
	  </copy>
	</target>

	<target name="copyinternalconfig">
	  <copy todir="${classes.dir}">
		<fileset dir="${src.dir}" includes="*.properties"/>
	  </copy>
	</target>
	
	<target name="copyoutsiteconfig">
	  <copy todir="${build.dir}">
		<fileset dir="${basedir}" includes="*.xml"/>
		<fileset dir="${basedir}" includes="*.sh"/>
	  </copy>
	</target>
	
	<target name="makeversion" depends="clean">
	  <echo file="${build.dir}/BUILD_VERSION">${touch.time}</echo>
	</target>
	
	<target name="jar" depends="compile, copyoutsiteconfig, copyinternalconfig, makeversion, copylib">
	  <jar destfile="${build.dir}/${jar.name}" basedir="${classes.dir}"/>
    </target>

</project>
